# 工程简介

1. openfeign 服务消费方
    
1.1. feign默认集成了ribbon(负载均衡)和hystrix(熔断)

1.1.1 配置负载均衡

    #连接超时时间(ms)
    ribbon.ConnectTimeout=1000
    #业务逻辑超时时间(ms)
    ribbon.ReadTimeout=6000
    
    #同一台实例最大重试次数,不包括首次调用
    ribbon.MaxAutoRetries=1
    #重试负载均衡其他的实例最大重试次数,不包括首次调用
    ribbon.MaxAutoRetriesNextServer=1
    #是否所有操作都重试
    ribbon.OkToRetryOnAllOperations=false
    
1.1.2. ribbon具备负载均衡和重试机制(重试多次失败，不再继续调，这是服务下线机制，一段时就按之后自动上线)，可配置

## Hystrix

spring cloud 用的是 hystrix，是一个容错组件。

Hystrix实现了 超时机制和断路器模式。

Hystrix是Netflix开源的一个类库，用于隔离远程系统、服务或者第三方库，防止级联失败，从而提升系统的可用性与容错性。主要有以下几点功能：

1. 为系统提供保护机制。在依赖的服务出现高延迟或失败时，为系统提供保护和控制。
2. 防止雪崩。
3. 包裹请求：使用HystrixCommand（或HystrixObservableCommand）包裹对依赖的调用逻辑，每个命令在独立线程中运行。
4. 跳闸机制：当某服务失败率达到一定的阈值时，Hystrix可以自动跳闸，停止请求该服务一段时间。
5. 资源隔离：Hystrix为每个请求都的依赖都维护了一个小型线程池，如果该线程池已满，发往该依赖的请求就被立即拒绝，而不是排队等候，从而加速失败判定。防止级联失败。
6. 快速失败：Fail Fast。同时能快速恢复。侧重点是：（不去真正的请求服务，发生异常再返回），而是直接失败。
7. 监控：Hystrix可以实时监控运行指标和配置的变化，提供近实时的监控、报警、运维控制。
8. 回退机制：fallback，当请求失败、超时、被拒绝，或当断路器被打开时，执行回退逻辑。回退逻辑我们自定义，提供优雅的服务降级。
9. 自我修复：断路器打开一段时间后，会自动进入“半开”状态，可以进行打开，关闭，半开状态的转换。前面有介绍。

使用了security安全验证